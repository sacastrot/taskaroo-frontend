var R=Object.defineProperty;var G=(t,s,a)=>s in t?R(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var b=(t,s,a)=>(G(t,typeof s!="symbol"?s+"":s,a),a);import{d as I,o as n,c as l,a as e,t as x,n as L,p as A,b as U,_ as M,r as u,w as C,m as O,F as S,g as D,i as k,j as J,e as K,f as Q,v as z,h as B,q as W}from"./index-BrTKmnHI.js";import{a as V,N as X,U as Y,b as N}from"./UserError-C9_7d6kK.js";class q{constructor(s,a,i,o){b(this,"id");b(this,"title");b(this,"description");b(this,"owner");b(this,"state");this.title=s,this.description=a,this.owner=i,this.state=o}getId(){return this.id}getTitle(){return this.title}getDescription(){return this.description}getOwner(){return this.owner}getState(){if(this.state!==void 0){if(this.state===0)return"pending";if(this.state===1)return"progress";if(this.state===2)return"done"}}getStateName(){if(this.state!==void 0){if(this.state===0)return"Pendiente";if(this.state===1)return"En pogreso";if(this.state===2)return"Hecho"}}setId(s){this.id=s}}const Z=t=>(A("data-v-8fb51cfe"),t=t(),U(),t),ee={class:"title font-bold text-xl mb-5"},te={class:"description flex gap-2"},se=Z(()=>e("p",{class:"font-bold"},"Descripción",-1)),ae={class:"status flex gap-2 mt-5"},oe={class:"font-bold"},ne=I({__name:"TaskCard",props:["task"],setup(t){const s=t;return(a,i)=>(n(),l("div",{class:L(["card flex flex-col p-4 shadow-md w-[25rem] max-w-md min-w-30 rounded-lg",{"bg-green text-black":s.task.getState()==="done","bg-red text-white":s.task.getState()==="pending","bg-yellow text-black":s.task.getState()==="progress"}])},[e("div",ee,x(s.task.getTitle()),1),e("div",te,[se,e("p",null,x(s.task.getDescription()),1)]),e("div",ae,[e("p",oe,x(s.task.getStateName()),1)])],2))}}),ie=M(ne,[["__scopeId","data-v-8fb51cfe"]]),E={fetchTasks:le,createTask:re,updateTask:ce};async function le(t){const s=[];try{const{data:a}=await V.get(`users/${t}/tasks/`);return a.forEach(i=>{const o=new q(i.title,i.description,i.owner,i.state);o.setId(i.id),s.push(o)}),s}catch(a){throw a instanceof X?new Y("No users found"):new N("An unknown error occurred while fetching users")}}async function re(t,s){try{const{data:a}=await V.post(`users/${s}/tasks/`,{title:t.getTitle(),description:t.getDescription()})}catch{throw new N("An unknown error occurred while creating a task")}}async function ce(t,s){try{const{data:a}=await V.put(`tasks/${s}/?state=${t}`)}catch{throw new N("An unknown error occurred while updating a task")}}const $=t=>(A("data-v-14f6b5e6"),t=t(),U(),t),de={class:"bg-modal h-screen w-screen flex justify-center items-center"},ue={class:"modal"},pe={class:"modal-content max-w-[40rem] min-w-[30rem] p-4 bg-white rounded-lg shadow"},_e={class:"title text-xl font-bold flex justify-between"},ve=$(()=>e("h1",null,"Cambio de estado",-1)),he={class:"body"},fe={class:"form-control"},me=$(()=>e("label",{for:"state"},"Estado",-1)),we=["value"],ke={class:"error pt-2 pl-1"},ge={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},xe=$(()=>e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),ye=$(()=>e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),be=[xe,ye],$e=$(()=>e("p",null,"Editar",-1)),Te=I({__name:"ModalUpdateTask",props:["id"],emits:["close","updateAction"],setup(t,{emit:s}){const{id:a}=t,i=s,o=u("Selecciona un estado"),y=["Selecciona un estado","Hecho","Pendiente","En progreso"],g=u(!1),p=()=>{i("close")},T=m=>{i("updateAction",m)},_=u(""),w=async()=>{g.value=!0;let m=-1;if(o.value==="Selecciona un estado"){_.value="Seleccione un estado";return}else _.value="";switch(o.value){case"Hecho":m=2;break;case"Pendiente":m=0;break;case"En progreso":m=1;break}try{await E.updateTask(m,a),T(!0)}catch{T(!1)}finally{g.value=!1}};return(m,r)=>(n(),l("div",de,[e("div",ue,[e("div",pe,[e("div",_e,[ve,e("span",{class:"material-symbols-outlined",onClose:r[0]||(r[0]=v=>p())}," close ",32)]),e("div",he,[e("div",fe,[me,C(e("select",{id:"state","onUpdate:modelValue":r[1]||(r[1]=v=>o.value=v)},[(n(),l(S,null,D(y,v=>e("option",{key:v,value:v},x(v),9,we)),64))],512),[[O,o.value]]),e("div",ke,[e("p",null,x(_.value),1)])]),e("button",{class:"flex gap-1",onClick:r[2]||(r[2]=v=>w())},[g.value?(n(),l("svg",ge,be)):k("",!0),$e])])])])]))}}),Ce=M(Te,[["__scopeId","data-v-14f6b5e6"]]),f=t=>(A("data-v-669d2e17"),t=t(),U(),t),Se={class:"container mx-auto mt-10"},Ee={class:"header flex justify-between items-center"},Ie=f(()=>e("div",{class:"text"},[e("h1",{class:"font-bold text-2xl"},"Tareas del usuario"),e("p",{class:"mt-2"},"Todas las tareas que tiene el usuario")],-1)),Ae=f(()=>e("span",{class:"material-symbols-outlined bg-green rounded-full text-white"}," add ",-1)),Ue=[Ae],Me={key:0,class:"mt-10"},Ve={key:0,class:"flex gap-5 flex-wrap"},Ne={key:1},ze={class:"form-container container mx-auto"},Be=f(()=>e("div",{class:"header"},[e("h2",null,"Nueva tarea")],-1)),De={class:"title"},qe=f(()=>e("label",{for:"title"}," Titulo ",-1)),He={class:"desc"},je=f(()=>e("label",{for:"description"}," Descripción ",-1)),Fe={class:"actions"},Pe={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Re=f(()=>e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),Ge=f(()=>e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),Le=[Re,Ge],Oe=f(()=>e("p",null,"Guardar",-1)),Je={key:1},Ke=f(()=>e("p",null,"Cargando ...",-1)),Qe=[Ke],We={key:2},Xe=f(()=>e("p",null,"Aún no hay tareas registradas, puedes crear una usando el botón más",-1)),Ye=[Xe],Ze={key:3,class:"message text-green success"},et={key:4,class:"message error text-red"},tt=I({__name:"TaskView",setup(t){const s=W(),a=u(!1);u(!1);const i=s.params.id,o=u(!1),y=u(),g=async()=>{try{y.value=await E.fetchTasks(i)}catch(c){console.error(c)}},p=J({title:"",description:""}),T=()=>{o.value=!0},_=u(""),w=u(""),m=async()=>{try{a.value=!0;const c=new q(p.title,p.description,void 0,void 0);await E.createTask(c,i),_.value="Tarea creada con éxito",setTimeout(()=>{_.value=""},3e3),o.value=!1,g()}catch{w.value="Error al crear la tarea, intenta de nuevo más tarde",setTimeout(()=>{w.value=""},3e3)}finally{p.title="",p.description="",a.value=!1}},r=u(!1),v=u(void 0),H=c=>{v.value=c,r.value=!0},j=c=>{r.value=!1,c?(g(),_.value="Tarea actualizada con éxito"):w.value="Error al actualizar la tarea, intenta de nuevo más tarde",setTimeout(()=>{_.value="",w.value=""},3e3)},F=K(()=>{var c;return(c=y.value)==null?void 0:c.length});return Q(()=>{g()}),(c,d)=>(n(),l(S,null,[e("main",Se,[e("div",Ee,[Ie,e("div",{class:"new-task",onClick:d[0]||(d[0]=h=>T())},Ue)]),y.value?(n(),l("div",Me,[o.value?k("",!0):(n(),l("div",Ve,[(n(!0),l(S,null,D(y.value,(h,P)=>(n(),B(ie,{key:P,task:h,onClick:st=>H(h.getId())},null,8,["task","onClick"]))),128))])),o.value?(n(),l("div",Ne,[e("div",ze,[Be,e("div",De,[qe,C(e("input",{class:"p-2",type:"text","onUpdate:modelValue":d[1]||(d[1]=h=>p.title=h)},null,512),[[z,p.title]])]),e("div",He,[je,C(e("textarea",{name:"desc",id:"description","onUpdate:modelValue":d[2]||(d[2]=h=>p.description=h)},null,512),[[z,p.description]])]),e("div",Fe,[e("button",{class:"bg-blue text-white",onClick:d[3]||(d[3]=h=>o.value=!1)},"Ver tareas"),e("button",{class:"bg-blue text-white flex gap-1",onClick:d[4]||(d[4]=h=>m())},[a.value?(n(),l("svg",Pe,Le)):k("",!0),Oe])])])])):k("",!0)])):(n(),l("div",Je,Qe)),F.value==0&&!o.value?(n(),l("div",We,Ye)):k("",!0),_.value?(n(),l("div",Ze,[e("p",null,x(_.value),1)])):k("",!0),w.value?(n(),l("div",et,[e("p",null,x(w.value),1)])):k("",!0)]),r.value?(n(),B(Ce,{key:0,id:v.value,onClose:d[5]||(d[5]=h=>r.value=!1),onUpdateAction:j},null,8,["id"])):k("",!0)],64))}}),it=M(tt,[["__scopeId","data-v-669d2e17"]]);export{it as default};
